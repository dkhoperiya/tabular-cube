{
  "name": "Customers",
  "dataView": "full",
  "source": {
    "type": "m",
    "expression": [
      "let",
      "    Source = #\"DWH\",",
      "    dbo_DimProjects = Source{[Schema=\"dbo\",Item=\"DimProjects\"]}[Data],",
      "    #\"Removed Other Columns\" = Table.SelectColumns(dbo_DimProjects,{\"Customer\"}),",
      "    #\"Filtered Rows\" = Table.SelectRows(#\"Removed Other Columns\", each ([Customer] <> null and [Customer] <> \"\")),",
      "    #\"Removed Duplicates\" = Table.Distinct(#\"Filtered Rows\"),",
      "    #\"Added Custom\" = Table.AddColumn(#\"Removed Duplicates\", \"Customer Group\", each if List.Contains({\"MTSru\",",
      "\"MTS IT\",",
      "\"ПАО «МТС»\",",
      "\"ООО «МТС ИТ»\"},[Customer]) then \"ПАО МТС\" else ",
      "if List.Contains({\"СООО «МТС» (Беларусь)\",",
      "\"MTSMinsk\",",
      "\"MTS UA\",",
      "\"ВОДАФОН Украина\",",
      "\"UK Sistema Capital\",",
      "\"UMS\",",
      "\"UMS (Узбекистан)\"},[Customer]) then \"3-и стороны\" else if List.Contains({\"MTS Bank\",",
      "\"ПАО «МГТС»\",",
      "\"АО «РТК»\",",
      "\"ПАО «НИС»\"},[Customer]) then \"ЗДК\" else \"Прочие\", type text),",
      " #\"Added Custom2\" = Table.AddColumn(#\"Added Custom\", \"Customer Group Id\", each if List.Contains({\"MTSru\",",
      "\"MTS IT\",",
      "\"ПАО «МТС»\",",
      "\"ООО «МТС ИТ»\"},[Customer]) then 1 else ",
      "if List.Contains({\"СООО «МТС» (Беларусь)\",",
      "\"MTSMinsk\",",
      "\"MTS UA\",",
      "\"ВОДАФОН Украина\",",
      "\"UK Sistema Capital\",",
      "\"UMS\",",
      "\"UMS (Узбекистан)\"},[Customer]) then 2 else if List.Contains({\"MTS Bank\",",
      "\"ПАО «МГТС»\",",
      "\"АО «РТК»\",",
      "\"ПАО «НИС»\"},[Customer]) then 3 else 4, Int64.Type)",
      "",
      "in",
      "    #\"Added Custom2\""
    ]
  }
}