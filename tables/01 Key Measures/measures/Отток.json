{
  "name": "Отток",
  "description": "Считается количество увольнений без учета повторно нанятых в том же периоде",
  "expression": [
    "VAR SelectedPeriod =",
    "    CALCULATETABLE ( VALUES ( Dates[Date] ) )",
    "VAR FiredEmpl =",
    "    CALCULATETABLE (",
    "        FILTER (",
    "            VALUES ( EmployeeMovements[EmployeeCode] ),",
    "            VAR LastDateX =",
    "                CALCULATE (",
    "                    MAX ( EmployeeMovements[Date] ),",
    "                    ALLEXCEPT ( EmployeeMovements, EmployeeMovements[EmployeeCode] ),",
    "                    SelectedPeriod",
    "                )",
    "            RETURN",
    "                CALCULATE (",
    "                    MAX ( EmployeeMovements[Balance] ),",
    "                    FILTER (",
    "                        ALLEXCEPT ( EmployeeMovements, EmployeeMovements[EmployeeCode] ),",
    "                        EmployeeMovements[Date] = LastDateX",
    "                    )",
    "                ) = 0",
    "        )",
    "    )",
    "RETURN",
    "    CALCULATE ( [Полный отток], FiredEmpl )"
  ],
  "formatString": "#,##0",
  "displayFolder": "09. HR\\02. HR - метрики",
  "detailRowsDefinition": {
    "expression": [
      "VAR SelectedPeriod =",
      "    CALCULATETABLE ( VALUES ( Dates[Date] ) )",
      "VAR FiredEmpl =",
      "    CALCULATETABLE (",
      "        FILTER (",
      "            VALUES ( EmployeeMovements[EmployeeCode] ),",
      "            VAR LastDateX =",
      "                CALCULATE (",
      "                    MAX ( EmployeeMovements[Date] ),",
      "                    ALLEXCEPT ( EmployeeMovements, EmployeeMovements[EmployeeCode] ),",
      "                    SelectedPeriod",
      "                )",
      "            RETURN",
      "                CALCULATE (",
      "                    MAX ( EmployeeMovements[Balance] ),",
      "                    FILTER (",
      "                        ALLEXCEPT ( EmployeeMovements, EmployeeMovements[EmployeeCode] ),",
      "                        EmployeeMovements[Date] = LastDateX",
      "                    )",
      "                ) = 0",
      "        )",
      "    )",
      "RETURN",
      "    CALCULATETABLE ( DETAILROWS ( [Полный отток] ), FiredEmpl )"
    ]
  }
}