{
  "name": "EverageWorkingTermByYear",
  "expression": [
    "/* Массив (таблица) выбранных дат */",
    "VAR selectedDates =",
    "    CALCULATETABLE (",
    "        VALUES ( Dates[Date] )",
    "    )",
    "    ",
    "/* Таблица экономически активных сотрудников по дням в рамках периода */",
    "VAR economicallyActiveEmployeesCapacity =",
    "    CALCULATETABLE (",
    "        Capacity,",
    "        Capacity[StatusCode] = 10,",
    "        Capacity[AssigmentCombinationStatus] = \"Основное назначение\",",
    "        Capacity[AssigmentTypeName] = \"STUFF\",",
    "        Capacity[EmploymentType] <> \"Стажер\"",
    "    )",
    "    ",
    "/* Количество уникальных сотрудников за период */",
    "VAR employeesCount =",
    "    CALCULATE (",
    "        DISTINCTCOUNT ( Capacity[EmployeeCode] ),",
    "        selectedDates,",
    "        economicallyActiveEmployeesCapacity",
    "    )",
    "    ",
    "/* Общее количество отработанных дней за период */",
    "VAR employeesWorkingDaysCount =",
    "    CALCULATE (",
    "        COUNT ( Capacity[EmployeeCode] ),",
    "        selectedDates,",
    "        economicallyActiveEmployeesCapacity",
    "    )",
    "   ",
    "/* Среднее время работы по дням */",
    "VAR everageWorkingTermByYears = CALCULATE(",
    "    DIVIDE ( employeesWorkingDaysCount, employeesCount, 0 )",
    ")",
    "    ",
    "RETURN",
    "    everageWorkingTermByYears"
  ],
  "formatString": "#,##0.00",
  "displayFolder": "09. HR"
}